<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Winter AR World</title>
    <meta name="description" content="Winter-themed WebAR with A-Frame">
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>

    <script>
      let placeSnowman = true;

      AFRAME.registerComponent('tap-to-place', {
        init() {
          this.el.sceneEl.addEventListener('click', (evt) => {
            const hit = evt.detail.intersection;
            if (!hit) return;

            const position = hit.point;
            const scene = this.el.sceneEl;

            let entity;
            if (placeSnowman) {
              entity = document.createElement('a-entity');
              entity.setAttribute('snowman', '');
            } else {
              entity = document.createElement('a-entity');
              entity.setAttribute('pine-tree', '');
            }

            entity.setAttribute(
              'position',
              `${position.x} ${position.y} ${position.z}`
            );

            scene.appendChild(entity);
            placeSnowman = !placeSnowman;
          });
        }
      });

      AFRAME.registerComponent('snowman', {
        init() {
          this.el.innerHTML = `
            <a-sphere position="0 0.3 0" radius="0.3" color="#FFFFFF"></a-sphere>
            <a-sphere position="0 0.75 0" radius="0.22" color="#FFFFFF"></a-sphere>
            <a-sphere position="0 1.1 0" radius="0.15" color="#FFFFFF"></a-sphere>

            <a-cone position="0 1.1 0.15" radius-bottom="0.03" height="0.2" color="#FF8C00" rotation="90 0 0"></a-cone>

            <a-sphere position="-0.05 1.15 0.13" radius="0.02" color="#000"></a-sphere>
            <a-sphere position="0.05 1.15 0.13" radius="0.02" color="#000"></a-sphere>
          `;
        }
      });

      AFRAME.registerComponent('pine-tree', {
        init() {
          this.el.innerHTML = `
            <a-cylinder position="0 0.25 0" radius="0.05" height="0.5" color="#8B4513"></a-cylinder>

            <a-cone position="0 0.7 0" radius-bottom="0.4" height="0.6" color="#0B6623"></a-cone>
            <a-cone position="0 1.0 0" radius-bottom="0.3" height="0.6" color="#0E7A33"></a-cone>
            <a-cone position="0 1.3 0" radius-bottom="0.2" height="0.6" color="#118C4F"></a-cone>
          `;
        }
      });
    </script>
  </head>

  <body>
    <a-scene
      xr-mode-ui="XRMode: xr"
      renderer="colorManagement: true; exposure: 1"
      shadow="type: pcfsoft"
      ar-hit-test="target: #ground"
      tap-to-place
    >
      <a-camera position="0 1.6 0"></a-camera>

      <a-light type="ambient" intensity="0.6"></a-light>
      <a-light type="directional" position="1 2 1" intensity="0.8"></a-light>

      <!-- Ground plane chosen automatically by AR engine -->
      <a-entity id="ground"></a-entity>

      <a-sky color="#E6F0FF" hide-on-enter-ar></a-sky>
    </a-scene>
  </body>
</html>

